<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>ğŸ† Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</title>
  <style>
    body {
      font-family:"Cairo",sans-serif;
      background:#f5f6f8;
      margin:0;direction:rtl;text-align:center;
    }
    .container{
      background:#fff;
      max-width:750px;
      margin:40px auto;
      padding:25px 20px;
      border-radius:15px;
      box-shadow:0 6px 20px rgba(0,0,0,0.1);
    }
    h1{color:#0da175;margin-bottom:20px;}
    section{margin:25px 0;padding:15px;border:1px solid #eee;border-radius:10px;}
    input,button,textarea{
      margin:7px 0;padding:10px;width:90%;font-size:1rem;
      border-radius:8px;border:1px solid #ccc;
    }
    button{
      background:#0da175;color:#fff;border:none;
      font-weight:bold;cursor:pointer;transition:0.3s;
    }
    button:hover{background:#087f59;}
    .status{font-weight:bold;color:#444;margin-top:10px;}
  </style>
</head>

<body>
  <div class="container">
    <h1>ğŸ† Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h1>

    <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
    <section id="settings">
      <h3>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©</h3>
      <label>ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©:</label><br>
      <input type="datetime-local" id="startTime"><br>

      <label>Ù…Ø¯Ø© Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© (Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚):</label><br>
      <input type="number" id="duration" value="10"><br>

      <button onclick="saveSettings()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
      <div class="status" id="settingsStatus"></div>
    </section>

    <!-- Ù‚Ø³Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
    <section id="questions">
      <h3>ğŸ“ Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„</h3>
      <textarea id="questionText" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§..." rows="3"></textarea><br>
      <input id="correctAnswer" placeholder="Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©"><br>
      <button onclick="addQuestion()">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„</button>
      <div id="questionsList" class="status"></div>
    </section>

    <!-- Ù‚Ø³Ù… Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
    <section id="results">
      <h3>ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
      <button onclick="loadQuestions()">ğŸ”„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©</button>
      <pre id="output"></pre>
    </section>
  </div>

  <!-- ğŸ”— ÙƒÙˆØ¯ Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
    import {
      getFirestore,
      collection,
      addDoc,
      getDocs,
      setDoc,
      doc
    } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBWiz4f-aEHwdv34hc81MBtQ3eTzJoeGis",
      authDomain: "studentquiz-afd8e.firebaseapp.com",
      projectId: "studentquiz-afd8e",
      storageBucket: "studentquiz-afd8e.appspot.com",
      messagingSenderId: "718901037670",
      appId: "1:718901037670:web:156f5a8428cf06c708bba7",
      measurementId: "G-GY57GPT97K"
    };

    const app = initializeApp(firebaseConfig);
    const db  = getFirestore(app);
    console.log("âœ… Ù…ØªØµÙ„ Ø¨Ù€ Firebase");

    // Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆÙ‚Øª Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©
    window.saveSettings = async function () {
      const start = document.getElementById('startTime').value;
      const duration = parseInt(document.getElementById('duration').value);
      if (!start || !duration) {
        document.getElementById('settingsStatus').textContent = "âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ù…Ø¯Ø©";
        return;
      }
      await setDoc(doc(db, "settings", "quizTime"), {
        startTime: start,
        duration: duration
      });
      document.getElementById('settingsStatus').textContent = "âœ… ØªÙ… Ø­ÙØ¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©";
    }

    // Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ù„Ù„Ø³Ø­Ø§Ø¨Ø©
    window.addQuestion = async function () {
      const text = document.getElementById('questionText').value.trim();
      const ans = document.getElementById('correctAnswer').value.trim();
      if (!text || !ans) return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø©");
      await addDoc(collection(db, "questions"), { text, answer: ans });
      document.getElementById('questionsList').textContent = "âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†";
      document.getElementById('questionText').value = "";
      document.getElementById('correctAnswer').value = "";
    }

    // Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø®Ø²Ù†Ø©
    window.loadQuestions = async function() {
      const qs = await getDocs(collection(db, "questions"));
      const out = document.getElementById('output');
      out.textContent = "";
      qs.forEach(doc => {
        out.textContent += "â“ " + doc.data().text + " â€” âœ… " + doc.data().answer + "\n";
      });
    }
  </script>
</body>
</html>
